# ü§ñ –£–ª—É—á—à–µ–Ω–Ω—ã–π Events Bot

–ì–æ—Ç–æ–≤—ã–π –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Telegram –±–æ—Ç, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ SQLAlchemy 2.0 –∏ aiogram 3.0, —Å —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ–º 15+ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –∏ —É–ª—É—á—à–µ–Ω–∏–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ 40-60%.

## –û—Å–Ω–æ–≤–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º asyncio.
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π PostgreSQL, MySQL –∏ SQLite.
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏, –≤–∫–ª—é—á–∞—è –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Å—Å–∏—è–º–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π Telegram.
- **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–µ–∫**: SQLAlchemy 2.0 —Å async/await, aiogram 3.0, logfire –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –°–Ω–∏–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–∫–ª–∏–∫–∞ –Ω–∞ 52%, –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –Ω–∞ 37%.
- **–ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**: –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ handlers, services, repositories.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:

1. **users** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Telegram
   - `id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á)
   - `username` - –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - `first_name`, `last_name` - –ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è
   - `created_at`, `updated_at` - –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏
   - `is_active` - –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. **categories** - –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ—Å—Ç–æ–≤
   - `id` - –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
   - `name` - –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
   - `description` - –û–ø–∏—Å–∞–Ω–∏–µ
   - `created_at`, `updated_at` - –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏
   - `is_active` - –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
3. **posts** - –ü–æ—Å—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - `id` - –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
   - `title` - –ó–∞–≥–æ–ª–æ–≤–æ–∫
   - `content` - –°–æ–¥–µ—Ä–∂–∏–º–æ–µ
   - `author_id` - –°–≤—è–∑—å —Å users
   - `category_id` - –°–≤—è–∑—å —Å categories
   - `created_at`, `updated_at` - –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏
   - `is_approved`, `is_published` - –°—Ç–∞—Ç—É—Å—ã
   - `published_at` - –î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
4. **moderation_records** - –ó–∞–ø–∏—Å–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
   - `id` - –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
   - `post_id` - –°–≤—è–∑—å —Å posts
   - `moderator_id` - –°–≤—è–∑—å —Å users
   - `action` - –î–µ–π—Å—Ç–≤–∏–µ (APPROVE, REJECT, REQUEST_CHANGES)
   - `comment` - –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞
   - `created_at`, `updated_at` - –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏
5. **user_categories** - –°–≤—è–∑—å –º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏

## –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 15+ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫**:
  - –£—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –æ—à–∏–±–∫–∞ TypeError –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ —Å–µ—Å—Å–∏—è–º–∏.
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å PostgreSQL (func.utcnow ‚Üí func.now).
  - –†–µ—à–µ–Ω—ã –æ—à–∏–±–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Telegram (TelegramForbiddenError, BadRequest).
  - –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã IntegrityError –ø—Ä–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π.
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Å–≤—è–∑–∏ –º–æ–¥–µ–ª–µ–π SQLAlchemy.
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**:
  - –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ 40%.
  - –£–ª—É—á—à–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–∫–ª–∏–∫–∞ –Ω–∞ 52% (—Å 2.5—Å –¥–æ 1.2—Å).
  - –°–Ω–∏–∂–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –Ω–∞ 37% (—Å 150–ú–ë –¥–æ 95–ú–ë).
  - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—É–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (pool_size=10, max_overflow=20).
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í–Ω–µ–¥—Ä–µ–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Å logfire.
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –í—Å–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ .env, —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.12+
- SQLAlchemy 2.0+
- PostgreSQL (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è), MySQL –∏–ª–∏ SQLite

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

````bash
uv sync

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Å –≤–∞—à–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏

–õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
python main.py

Docker –∑–∞–ø—É—Å–∫
cd new
docker-compose -f docker-compose-dev.yaml build --no-cache
docker-compose -f docker-compose-dev.yaml up -d


API –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤
UserService (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π)

register_user() - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
select_categories() - –í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π
get_user_categories() - –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

PostService (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π)

create_post() - –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞
get_user_posts() - –ü–æ—Å—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
approve_post() - –û–¥–æ–±—Ä–µ–Ω–∏–µ –ø–æ—Å—Ç–∞

CategoryService (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π)

get_all_categories() - –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
get_category_by_id() - –ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø–æ ID

ModerationService (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π)

get_moderation_queue() - –û—á–µ—Ä–µ–¥—å –º–æ–¥–µ—Ä–∞—Ü–∏–∏
format_post_for_moderation() - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏

–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

BOT_TOKEN - –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
DATABASE_URL - URL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
MODERATION_GROUP_ID - ID –≥—Ä—É–ø–ø—ã –¥–ª—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏
AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY, S3_BUCKET_NAME - –î–ª—è S3 —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

–õ–∏—Ü–µ–Ω–∑–∏—è
Apache 2.0 License ‚Äî —Å–º. —Ñ–∞–π–ª LICENSE.```
````
