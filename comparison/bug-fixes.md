# üîç –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –û—à–∏–±–æ–∫

–î–æ–∫—É–º–µ–Ω—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–æ–≤ –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏–π. –ö–∞–∂–¥–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç: –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥, –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç.

---

## 1. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –ë–î

**–î–æ:**

```python
async with get_db_session() as session:
    await session.execute(query)
```

**–ü—Ä–æ–±–ª–µ–º–∞:** `get_db_session` –≤–æ–∑–≤—Ä–∞—â–∞–ª –∫–æ—Ä—É—Ç–∏–Ω—É, –∏–∑-–∑–∞ —á–µ–≥–æ –≤–æ–∑–Ω–∏–∫–∞–ª `TypeError`.

**–ü–æ—Å–ª–µ:**

```python
async with await get_db_session() as session:
    await session.execute(query)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–æ–∫.

---

## 2. –£—Ç–µ—á–∫–∏ aiohttp

**–î–æ:**

```python
session = aiohttp.ClientSession()
response = await session.get(url)
```

**–ü—Ä–æ–±–ª–µ–º–∞:** `session` –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–ª—Å—è, –æ—Å—Ç–∞–≤–∞–ª–∏—Å—å –æ—Ç–∫—Ä—ã—Ç—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

**–ü–æ—Å–ª–µ:**

```python
async with aiohttp.ClientSession() as session:
    response = await session.get(url)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —É—Ç–µ—á–µ–∫.

---

## 3. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ü–∏–∫–ª–∞ —Å–æ–±—ã—Ç–∏–π

**–î–æ:**

```python
def heavy_task():
    ... # CPU-bound —Ä–∞–±–æ—Ç–∞

async def handler():
    heavy_task()  # –±–ª–æ–∫–∏—Ä—É–µ—Ç event loop
```

**–ü–æ—Å–ª–µ:**

```python
loop = asyncio.get_running_loop()
await loop.run_in_executor(None, heavy_task)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** UI –Ω–µ –∑–∞–≤–∏—Å–∞–µ—Ç, –±–æ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å.

---

## 4. –û—à–∏–±–∫–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ JSON

**–î–æ:**

```python
return {"created": datetime.utcnow()}
```

**–ü—Ä–æ–±–ª–µ–º–∞:** `TypeError: Object of type datetime is not JSON serializable`.

**–ü–æ—Å–ª–µ:**

```python
return {"created": datetime.utcnow().isoformat()}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** —É—Å–ø–µ—à–Ω–∞—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞.

---

## 5. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–î–æ:**

```python
# –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ —Ä–µ—Å—É—Ä—Å—ã –Ω–µ –æ—Å–≤–æ–±–æ–∂–¥–∞—é—Ç—Å—è
```

**–ü–æ—Å–ª–µ:**

```python
async def on_shutdown():
    await session.close()
    await redis.close()
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∏—Å—è—â–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.

---

## 6. –†–∞–±–æ—Ç–∞ —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏

**–î–æ:**

```python
session.commit()
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ø—Ä–∏ –æ—à–∏–±–∫–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å —á–∞—Å—Ç–∏—á–Ω–æ.

**–ü–æ—Å–ª–µ:**

```python
try:
    session.commit()
except Exception:
    session.rollback()
    raise
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î.

---

## 7. –¢–∞–π–º–∞—É—Ç—ã HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤

**–î–æ:**

```python
await session.get(url)
```

**–ü–æ—Å–ª–µ:**

```python
await session.get(url, timeout=10)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –±–æ—Ç –Ω–µ –∑–∞–≤–∏—Å–∞–µ—Ç –Ω–∞ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö.

---

## 8. –ö—ç—à Redis

**–î–æ:**

```python
await redis.set(key, value)
```

**–ü–æ—Å–ª–µ:**

```python
await redis.set(key, value, ex=3600)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –∫–ª—é—á–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å—Ç–µ–∫–∞—é—Ç, –ø–∞–º—è—Ç—å –Ω–µ –ø–µ—Ä–µ–ø–æ–ª–Ω—è–µ—Ç—Å—è.

---

## 9. –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π

**–î–æ:**

```python
await bot.send_message(chat_id, "Hello!")
```

**–ü–æ—Å–ª–µ:**

```python
await bot.send_message(chat_id, _("–ü—Ä–∏–≤–µ—Ç!"))
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –Ω—É–∂–Ω–æ–º —è–∑—ã–∫–µ.

---

## 10. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–î–æ:**

```python
print("Error happened")
```

**–ü–æ—Å–ª–µ:**

```python
logger.error("–û—à–∏–±–∫–∞", extra={"context": "db_query"})
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ JSON-–ª–æ–≥–∏, –ª–µ–≥–∫–æ –∏—Å–∫–∞—Ç—å.

---

–≠—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±–µ—Å–ø–µ—á–∏–ª–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, —É—Å—Ç—Ä–∞–Ω–∏–ª–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ –ø—Ä–æ–µ–∫—Ç –∫ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.
